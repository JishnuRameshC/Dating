{% extends 'shared/base.html' %}
{% load static %}




{% block content %}
    <div class="cust-body">
        <div class="spin-container">
            <div id="profile-info" class="prof-inform">
                <p id="profile-distance"></p>
                <img id="profile-pic" class="prof-pictures">
                <h2 id="profile-name"></h2>
                <button class="like-button">Like</button>
            </div>
            <div class="circle-container">
                <!-- SVG Animation --> 
                <svg id="circle-svg" viewBox="0 0 100 100">
                    <defs>
                        <radialGradient id="grad1" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                            <stop offset="0%" style="stop-color:rgba(255,255,255,0.1);stop-opacity:0" />
                            <stop offset="100%" style="stop-color:rgba(255,255,255,0.5);stop-opacity:1" />
                        </radialGradient>
                    </defs>
                    <circle cx="50" cy="50" r="35" stroke="url(#grad1)" stroke-width="3" fill="none" />
                    <circle cx="50" cy="50" r="45" stroke="url(#grad1)" stroke-width="3" fill="none" />
                    <circle cx="50" cy="50" r="55" stroke="url(#grad1)" stroke-width="3" fill="none" />
                    <circle cx="50" cy="50" r="65" stroke="url(#grad1)" stroke-width="3" fill="none" />
                </svg>
            </div>
            <div class="spin-button-container">
                <button class="spin-button" onclick="spinProfile()">
                    Spin here
                </button>
            </div>
        </div>
    </div>
    <script>
        let isSpinning = false;
        const svgElement = document.querySelector('#circle-svg');

        function spinProfile() {
            if (!isSpinning) {
                isSpinning = true;
                svgElement.classList.add('spin-animation');

                // Wait for 6 seconds before showing a random profile
                setTimeout(() => {
                    fetchRandomProfile();
                }, 6000);
            }
        }

        function fetchRandomProfile() {
            fetch("{% url 'Dating:get_random_profile' %}")
                .then(response => response.json())
                .then(data => {
                    if (!data.error) {
                        document.getElementById('profile-name').textContent = data.name;
                        document.getElementById('profile-distance').textContent = data.distance;
                        document.getElementById('profile-pic').src = data.image_url;
                    } else {
                        console.error('Error fetching profile:', data.error);
                    }
                    isSpinning = false;
                    svgElement.classList.remove('spin-animation');
                })
                .catch(error => {
                    console.error('Error:', error);
                    isSpinning = false;
                    svgElement.classList.remove('spin-animation');
                });
        }
    </script>
{% endblock %}